Database:
Sales Table - [ Date, Order_id, Item_id, Customer_id, Quantity, Revenue ]
Items Table – [ item_id, item_name, price, department ]
Customers Table - [ Customer_id, first_name, last_name, address ]


1. Pull total number of orders that were completed on 18th March 2023

SELECT Date, COUNT(DISTINCT Order_id) as Total_no_Orders
FROM Sales
WHERE CAST(Date AS string) = "03-18-2023"
GROUP BY Date

2. Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’.

SELECT S.Date, S.Customer_id, C.first_name, C.last_name, COUNT(DISTINCT S.Order_id) as Total_no_Orders
FROM Sales as S
JOIN Customers as C
ON S.Customer_id = C.Customer_ID
WHERE UPPER(C.first_name) = "JOHN" AND UPPER(C.last_name) = "DOE"
AND CAST(Date AS string) = "03-18-2023"
GROUP BY S.Customer_id

3. Pull total number of customers that purchased in January 2023 and the average amount spend per customer.

SELECT COUNT(DISTINCT S.Customer_id) as Jan2023_Customers, 
SUM(S.revenue)/COUNT(DISTINCT S.Customer_id) as Avg_Customer_Spend
FROM Sales
WHERE CAST(S.Date AS string) LIKE "%-01-2023"


4. Pull the departments that generated less than $600 in 2022.

SELECT I.Department, COALESCE(SUM(S.Revenue),0) as Dept_Revenue
FROM Items as I
LEFT JOIN Sales as S ON I.Item_id = S.Item_id
WHERE CAST(S.Date AS string) LIKE "%2022" OR S.Date IS NULL 
AND COALESCE(SUM(S.Revenue), 0) < 600
GROUP BY I.department


5. What is the most and least revenue we have generated by an order?



6. What were the orders that were purchased in our most lucrative order
